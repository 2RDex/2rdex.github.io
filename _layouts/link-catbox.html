<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="utf-8">
  <title>Catbox Redirect</title>
  <meta name="robots" content="noindex">
  <script>
    (function () {
      const p = new URLSearchParams(location.search);
      let url = (p.get('url') || '').trim();
      let ext = (p.get('ext') || '').trim().toLowerCase();

      // ถ้า url มี . (เช่น 1njba5.png) → แยกออกเป็น code กับ ext
      if (url && !ext && url.includes('.')) {
        const parts = url.split('.');
        if (parts.length === 2) {
          url = parts[0];
          ext = parts[1].toLowerCase();
        }
      }

      // ตรวจสอบความถูกต้อง
      const okUrl = /^[a-zA-Z0-9]+$/.test(url);
      const okExt = /^[a-z0-9]+$/.test(ext);

      if (okUrl && okExt) {
        location.replace(`https://files.catbox.moe/${url}.${ext}`);
        return;
      }

      // ถ้าไม่ถูกต้อง → แสดงวิธีใช้
      document.addEventListener('DOMContentLoaded', () => {
        const base = ( "{{ site.url }}{{ site.baseurl }}" || window.location.origin ).replace(/\/+$/,'');
        document.body.innerHTML = `
          <h1>Catbox Redirect</h1>
          <p>Usage ตัวอย่าง:</p>
          <ul>
            <li><code>${base}/c/?url=1njba5&ext=png</code></li>
            <li><code>${base}/c/?url=1njba5.png</code></li>
          </ul>
          <p>จะไปที่: <code>https://files.catbox.moe/1njba5.png</code></p>
        `;
      });
    })();
  </script>
</head>
<body>
  <p>Redirecting…</p>
</body>
</html>